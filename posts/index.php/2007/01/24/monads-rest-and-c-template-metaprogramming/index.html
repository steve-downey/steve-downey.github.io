<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Monads, REST and C++ Template Metaprogramming | What Comes to Mind</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw==" crossorigin="anonymous" referrerpolicy="no-referrer">
<link rel="stylesheet" href="../../../../../../assets/css/rst.min.css">
<link rel="stylesheet" href="../../../../../../assets/css/foundation.min.css">
<link rel="stylesheet" href="../../../../../../assets/css/app.css">
<link rel="stylesheet" href="../../../../../../assets/css/modus-vivendi-tinted.css">
<link href="../../../../../../assets/css/custom.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../../../rss.xml">
<link rel="alternate" type="application/atom+xml" title="Atom" href="../../../../../../feed.atom">
<link rel="canonical" href="https://sdowney.org/posts/index.php/2007/01/24/monads-rest-and-c-template-metaprogramming/">
<!--[if lt IE 9]><script src="../../../../../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Steve Downey">
<link rel="prev" href="../../20/rest-in-peace-robert-anton-wilson/" title="rest in peace robert anton wilson" type="text/html">
<link rel="next" href="../../../02/02/functional-programming-in-c-part-1/" title="Functional Programming in C++ Part 1" type="text/html">
<meta property="og:site_name" content="What Comes to Mind">
<meta property="og:title" content="Monads, REST and C++ Template Metaprogramming">
<meta property="og:url" content="https://sdowney.org/posts/index.php/2007/01/24/monads-rest-and-c-template-metaprogramming/">
<meta property="og:description" content="OK, with that title, I'm sure to please almost no one. If you want to know how to do REST-ful programming in Haskell, or tie REST to C++, move along, there's nothing to see here. The connection isn't ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2007-01-24T04:08:00-05:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@sdowney.org">
<meta name="twitter:creator" content="@sdowney">
</head>
<body>

    

    
<div class="top-bar">
<div class="top-bar-left">
<ul class="menu">
<li class="menu-text"><a href="https://sdowney.org/" title="What Comes to Mind" rel="home">What Comes to Mind</a></li>
                <li><a href="../../../../../../archive.html">Archives</a></li>
                <li><a href="../../../../../../categories/index.html">Tags</a></li>
                <li><a href="mailto:sdowney@sdowney.dev"><i class="fa fa-envelope"></i></a></li>
                <li><a href="https://github.com/steve-downey">GitHub <i class="fa-brands fa-square-github"></i></a></li>
                <li><a href="https://mastodon.social/@Sdowney">Mastodon <i class="fa-brands fa-mastodon"></i></a></li>
                <li><a href="https://bsky.app/profile/sdowney.bsky.social">Bluesky <i class="fa-brands fa-square-bluesky"></i></a></li>
                <li><a href="../../../../../../feed.atom">ATOM <i class="fa-solid fa-atom"></i></a></li>
                <li><a href="../../../../../../rss.xml">RSS <i class="fa-solid fa-rss"></i></a></li>
    
    
    </ul>
</div>
</div>

    

<div class="callout large primary">
<div class="row column text-center">

    <h1>Monads, REST and C++ Template Metaprogramming</h1>
    <h2 class="subheader"><small>2007-01-24 04:08</small></h2>

</div>
</div>

<div class="row medium-8 large-7 columns">

<div class="blog-post">
    
    


    <p>OK, with that title, I'm sure to please almost no one. If you want to know how to do REST-ful programming in Haskell, or tie REST to C++, move along, there's nothing to see here. The connection isn't at the implementation level. Which is the whole point.<br>So what do REST,  Monads and (successful)  Template Metaprogramming have in common?<br>Strict maintenance of levels of abstraction, and extremely narrow interfaces between those levels.<br>What does that get you?<br>Extremely (and possibly maximally) reusable abstractions (code).<br>What triggered the realization for me was a paper on Arrows by Hughes, which asked the question 'Why are Monads so reusable when the have such a small interface', although not in those exact words. It dawned on me that they are so reusable exactly because they have such a narrow, but still very well defined, interface. They can do that because Monads are all about abstracting out features. A particular Monad will delagate all the real work down to the type it is being run over. Its real job is constraining the ways the values of the types it is a Monad over can be combined.<br>The analogue I have in mind for C++ MP is the swap() method. In a C++ template, we can assume that we can call swap on two values, that we otherwise know nothing about, and that the two values will be exchanged in a way that does not throw any exceptions, and is the best way of exchanging two values of that type. The abstract notion of swapping two values is delegated to the concrete implementation of the type being templated over.<br>A REST-ful web application exposes PUT, GET, POST, and DELETE on resources named by a URI.  Nominally not much to have a really rich experience. OTOH, Google Map mashups  contradict that.<br>It's not the richness of the interface of the metalevel, it's the richness allowed at level below. The narrow, but well defined, interface, where that interface delegates to a lower level abstraction, is exactly what enables composeability.<br>Monads, being firmly grounded in Functors in Category Theory, take this to an extreme level of rigor. There are laws that must be satisfied for a thing to be called a Monad, and those laws ensure that other Monads can interoperate, and achieve the Principle of Least Surprise.<br>I'm not intending this to be Yet Another Monad Tutorial. So I won't go too deep here. But monad transformers show a degree of generic reusability that is awfully hard to achieve with C++ templates, even though C++ templates have similar expressive power (with a horribly clumsy syntax).<br>Monads are functions (functors) that take types to types, and so correspond to mpl metafunctions. But they preserve the underlying structure on the types they operate over. In particular, composition is preserved. So if I have an function of type a -&gt; M b, and a function b -&gt; c, I get a working a -&gt; M c for free, just by using fmap. In C++ it would be like<br>template<typename b> foo(A)<br>and<br>C bar(B)<br>getting you to<br>template<c> foo(A)  by saying template fmap<foo>(a,b), or even better just fmap(a,b) and letting the compiler figure out types.<br>(where foo is something like<br>template<typename> foo(A a);)<br>That looks so impossible in C++, that most C++ programmers have no intuition about it.<br>But every time you wish that you didn't have to write some type that the compiler already knows, like the iterator or value_type or return_value, particularly when they get really messy, you're looking for what Monads, or at least what Hindley-Milner type inference, provide.</typename></foo></c></typename></p>

    <div class="callout">
    <ul class="menu simple">
<li>Author: Steve Downey</li>

    </ul>
</div>
    

    
        <div class="column row">
            <ul class="pagination" role="navigation" aria-label="Pagination">
<li>
                    <a href="../../20/rest-in-peace-robert-anton-wilson/" rel="prev" title="rest in peace robert anton wilson">« <span class="show-for-sr">Previous post</span></a>
                </li>
                <li>
                    <a href="../../../02/02/functional-programming-in-c-part-1/" rel="next" title="Functional Programming in C++ Part 1" aria-label="Next page">» <span class="show-for-sr">Next post</span></a>
                </li>
            </ul>
</div>

    
    


</div>



<hr>
<footer id="footer"><p><small>Contents © 2025         <a href="mailto:sdowney@sdowney.dev">Steve Downey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a> - 
 <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
 <img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a></small></p>
            
        </footer>
</div>

    



<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VGV27RDN3E"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VGV27RDN3E');
</script>
</body>
</html>
